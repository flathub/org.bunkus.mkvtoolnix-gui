app-id: org.bunkus.mkvtoolnix-gui
default-branch: stable
runtime: org.kde.Platform
runtime-version: '5.15'
sdk: org.kde.Sdk
command: mkvtoolnix-gui
rename-icon: mkvtoolnix-gui
finish-args:
  - --socket=wayland
  - --share=ipc
  - --socket=x11
  - --device=dri
  - --socket=pulseaudio
  - --filesystem=host
cleanup:
  - /include
  - /lib/cmake
  - /lib/pkgconfig
  - /share/man
  - '*.a'
  - '*.la'
modules:

  - name: boost
    buildsystem: simple
    build-commands:
      - mkdir -p /app/include
      - cp -R boost /app/include
    sources:
      - type: archive
        url: https://boostorg.jfrog.io/artifactory/main/release/1.77.0/source/boost_1_77_0.tar.bz2
        sha256: fc9f85fc030e233142908241af7a846e60630aa7388de9a5fafb1f3a26840854

  - name: cmark
    buildsystem: cmake-ninja
    builddir: true
    config-opts:
      - -DCMAKE_BUILD_TYPE=RelWithDebInfo
      - -DCMARK_STATIC=OFF
    cleanup:
      - /bin
    sources:
      - type: archive
        url: https://github.com/commonmark/cmark/archive/refs/tags/0.30.2.tar.gz
        sha256: 6c7d2bcaea1433d977d8fed0b55b71c9d045a7cdf616e3cd2dce9007da753db3

  - name: libdvdcss
    sources:
      - type: archive
        url: https://download.videolan.org/pub/libdvdcss/1.4.3/libdvdcss-1.4.3.tar.bz2
        sha256: 233cc92f5dc01c5d3a96f5b3582be7d5cee5a35a52d3a08158745d3d86070079

  - name: libdvdread
    sources:
      - type: archive
        url: https://download.videolan.org/pub/videolan/libdvdread/6.1.2/libdvdread-6.1.2.tar.bz2
        sha256: cc190f553758ced7571859e301f802cb4821f164d02bfacfd320c14a4e0da763

  - name: mkvtoolnix
    buildsystem: simple
    build-commands:
      - ./configure
        --enable-optimization
        --enable-debug
        --prefix=/app
        --with-docbook-xsl-root=/usr/share/xml/docbook/xml/xsl-stylesheets
        --disable-update-check
      - rake
      - rake install
    sources:
      - type: archive
        url: https://mkvtoolnix.download/sources/mkvtoolnix-65.0.0.tar.xz
        sha256: 0dddc9cc1bae26ceaac3a184482c50e6bb8add2d62e06ef08b55f9f0108bb92e
